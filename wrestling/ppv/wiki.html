<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.3.2/css/flag-icons.min.css">
    <title>Annual Promotion Schedule</title>
    <link rel="stylesheet" href="/css/wiki.css">
</head>
<body>

<h1>Annual Promotion Schedule</h1>
<p><em>World Title Series · World Championship Wrestling — 32-card rotating calendar</em></p>

<div class="sched-legend">
    <div class="sched-legend-item">
        <span class="sched-legend-swatch sw-M"></span>
        <strong>M</strong>&nbsp;Multiman contender (gauntlet / chamber / battle royal)
    </div>
    <div class="sched-legend-item">
        <span class="sched-legend-swatch sw-C"></span>
        <strong>C</strong>&nbsp;#1 Contender final (1-on-1)
    </div>
    <div class="sched-legend-item">
        <span class="sched-legend-swatch sw-D"></span>
        <strong>D</strong>&nbsp;Title Defense
    </div>
    <div class="sched-legend-item">
        <span class="sched-legend-swatch sw-T"></span>
        Shows 8 &amp; 24 — Tournament specials
    </div>
    <div class="sched-legend-item" style="margin-left:8px">
        <span class="sched-legend-swatch sw-org sw-wwf"></span>&nbsp;WWF&nbsp;
        <span class="sched-legend-swatch sw-org sw-wwo"></span>&nbsp;WWO&nbsp;
        <span class="sched-legend-swatch sw-org sw-iwb"></span>&nbsp;IWB
    </div>
</div>

<div class="sched-wrap">
    <table id="sched">
        <caption>Championship Pipeline · 32-Show Rotation</caption>
        <thead id="schedHead"></thead>
        <tbody id="schedBody"></tbody>
    </table>
</div>

<h2>Sequence validation</h2>
<p>Every belt must read M/C → D → M/C → D throughout the year.</p>
<div id="valWrap"></div>

<script>
/* ══════════════════════════════════════════
   CONFIGURATION
   ══════════════════════════════════════════ */

const TOTAL_SHOWS = 32;
const TOURNAMENT  = new Set([8, 24]);
const N           = 30;   // active shows

const activeShows = [];
for (let s = 1; s <= TOTAL_SHOWS; s++)
    if (!TOURNAMENT.has(s)) activeShows.push(s);

const WC_LIST = [
    { label: 'Heavyweight',   spec: '224+ lb / 102+ kg' },
    { label: 'Bridgerweight', spec: '≤224 lb / 102 kg'  },
    { label: 'Middleweight',  spec: '202 lb / 92 kg'    },
    { label: 'Welterweight',  spec: '180 lb / 82 kg'    },
    { label: 'Lightweight',   spec: '+140 lb / +64 kg'  },
    { label: 'Featherweight', spec: '140 lb / 64 kg'    },
];
const ORGS = ['WWF', 'WWO', 'IWB'];

const belts = [];
for (const wc of WC_LIST)
    for (const org of ORGS)
        belts.push({
            displayName: `${org} ${wc.label}`,
            org:         org.toLowerCase(),
            wcKey:       wc.label,
            wcHeader:    `${wc.label.toUpperCase()} — ${wc.spec}`,
        });

/* ══════════════════════════════════════════
   ALGEBRAIC SCHEDULE
   
   c_idx(b,p) = (b + p×5) % 30  → M or C
   d_idx(b,p) = (b + p×5 + 2) % 30  → D
   
   Pairs 0 and 3 → M (multiman)
   Pairs 1, 2, 4, 5 → C (one-on-one)
   
   Proven load: [7,7,8,7,7] × 6 = 216 total.
   ══════════════════════════════════════════ */

const PAIR_TYPE = ['M', 'C', 'C', 'M', 'C', 'C'];

const schedule = belts.map(() => ({}));

belts.forEach((_, b) => {
    for (let p = 0; p < 6; p++) {
        const cIdx  = (b + p * 5)     % N;
        const dIdx  = (b + p * 5 + 2) % N;
        schedule[b][activeShows[cIdx]] = PAIR_TYPE[p];
        schedule[b][activeShows[dIdx]] = 'D';
    }
});

/* ══════════════════════════════════════════
   BUILD TABLE HEAD
   ══════════════════════════════════════════ */
const thead = document.getElementById('schedHead');
const hRow  = document.createElement('tr');

const thB = document.createElement('th');
thB.className   = 'belt-label-head';
thB.textContent = 'Championship';
hRow.appendChild(thB);

for (let s = 1; s <= TOTAL_SHOWS; s++) {
    const th = document.createElement('th');
    th.textContent = s;
    if (TOURNAMENT.has(s)) th.classList.add('th-tournament');
    hRow.appendChild(th);
}
thead.appendChild(hRow);

/* ══════════════════════════════════════════
   BUILD TABLE BODY
   ══════════════════════════════════════════ */
const tbody   = document.getElementById('schedBody');
let lastWcKey = null;

belts.forEach((belt, b) => {
    if (belt.wcKey !== lastWcKey) {
        lastWcKey = belt.wcKey;
        const hr  = document.createElement('tr');
        hr.className = 'wc-header';
        const htd = document.createElement('td');
        htd.colSpan   = TOTAL_SHOWS + 1;
        htd.textContent = belt.wcHeader;
        hr.appendChild(htd);
        tbody.appendChild(hr);
    }

    const tr  = document.createElement('tr');

    const tdN = document.createElement('td');
    tdN.className   = `belt-label org-${belt.org}`;
    tdN.textContent = belt.displayName;
    tr.appendChild(tdN);

    for (let s = 1; s <= TOTAL_SHOWS; s++) {
        const td = document.createElement('td');
        if (TOURNAMENT.has(s)) {
            td.className   = 'td-tournament';
            td.textContent = '—';
        } else {
            const type = schedule[b][s];
            if (type) { td.textContent = type; td.className = `cell-${type}`; }
        }
        tr.appendChild(td);
    }

    tbody.appendChild(tr);
});

/* ══════════════════════════════════════════
   VALIDATION TABLE
   ══════════════════════════════════════════ */
const valDiv = document.getElementById('valWrap');
const valTbl = document.createElement('table');

const vHead = valTbl.createTHead().insertRow();
['Belt', 'Chronological sequence', 'Pairs valid?', 'M', 'C', 'D'].forEach(h => {
    const th = document.createElement('th');
    th.textContent = h;
    vHead.appendChild(th);
});

const vBody = valTbl.createTBody();

belts.forEach((belt, b) => {
    const sorted = Object.entries(schedule[b])
        .map(([s, t]) => [+s, t])
        .sort((a, c) => a[0] - c[0]);

    const types  = sorted.map(([, t]) => t);
    let   valid  = types.length === 12;
    for (let i = 0; i < types.length && valid; i++) {
        if (i % 2 === 0 && types[i] === 'D')                     valid = false;
        if (i % 2 === 1 && (types[i] === 'M' || types[i] === 'C')) valid = false;
    }

    const mC = types.filter(t => t === 'M').length;
    const cC = types.filter(t => t === 'C').length;
    const dC = types.filter(t => t === 'D').length;

    const seqStr = sorted
        .map(([s, t]) => `<span style="font-size:.8em;color:#888">${s}:</span><strong>${t}</strong>`)
        .join(' ');

    const tr = vBody.insertRow();
    [belt.displayName, seqStr, valid ? '✓' : '✗ FAIL', mC, cC, dC].forEach((v, col) => {
        const td = tr.insertCell();
        if (col === 1) td.innerHTML = v; else td.textContent = v;
        if (col === 2) td.className = valid ? 'val-ok' : 'val-warn';
    });
});

valDiv.appendChild(valTbl);
</script>
</body>
</html>